webpackJsonp([11],{Kca0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),r=a("vMJZ"),l=a("vLgD");var o=a("STSY"),n=a("NYxO"),d={directives:{waves:a("cAgV").a},data:function(){return{list:null,listLoading:!1,listPageParams:{pageNo:0,pageNum:20,username:""},tableKey:0,total:null,dialogFormVisible:!1,dialogStatus:"",dialogTitleMap:{update:"编辑",create:"创建"},editForm:{username:"",password:"",statu:"",deptName:"",deptId:"",roleId:""},editFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:5,max:10,message:"长度在 5 到 10 个字符",trigger:"blur"}],deptId:[{required:!0,message:"请选择部门",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}],statu:[{required:!0,message:"请选择状态",trigger:"blur"}]},editRolesOptions:[],editIsDisabled:{0:!1,1:!0},statusOptions:[0,1],treeDialogVisible:!1,treeDeptData:[],treeCheckedKeys:[],treeDefaultProps:{children:"children",label:"name"}}},created:function(){this.getUserList(),this.user_upd=this.permissions.user_upd,this.user_del=this.permissions.user_del,this.user_add=this.permissions.user_add},methods:{getUserList:function(){var e=this;this.listLoading=!0,Object(r.g)(this.listPageParams).then(function(t){e.list=t.data.list,e.total=t.data.total,e.listLoading=!1})},handleAdd:function(){this.formReset(),this.dialogStatus="create",this.dialogFormVisible=!0},handleSearch:function(){this.listPageParams.pageNo=0,this.getUserList()},handlePageNumChange:function(e){this.listPageParams.pageNum=e,this.getUserList()},handlePageNoChange:function(e){this.listPageParams.pageNo=e,this.getUserList()},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该用户(用户名:"+e.username+"), 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.b)(e.userId).then(function(e){e.data?(t.getUserList(),t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})):t.$notify({title:"失败",message:"删除失败",type:"error",duration:2e3})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},formCreate:function(e){var t=this;this.$refs[e].validate(function(e){return e?(Object(r.a)(t.editForm).then(function(e){e.data?(t.dialogFormVisible=!1,t.getUserList(),t.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3})):t.$notify({title:"失败",message:"添加失败",type:"error",duration:2e3})}),e):e})},formCancel:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()},formEdit:function(e){var t=this;this.formReset(),this.dialogStatus="update",this.dialogFormVisible=!0,Object(r.f)(e.userId).then(function(e){t.editForm.username=e.data.username,t.editForm.password="",t.editForm.statu=e.data.statu,t.editForm.deptId=e.data.deptId,t.editForm.userId=e.data.userId})},formUpdate:function(e){var t=this;this.$refs[e].validate(function(e){return e?(Object(r.i)(t.editForm).then(function(e){e.data?(t.dialogFormVisible=!1,t.getUserList(),t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})):t.$notify({title:"失败",message:"修改失败",type:"error",duration:2e3})}),e):e})},formReset:function(){this.editForm={username:"",password:"",statu:"",deptName:"",deptId:"",roleId:""}},handleDept:function(){var e,t=this;Object(l.a)({url:"/admin/dept/tree",method:"get",params:e}).then(function(e){t.treeDeptData=e.data,t.treeDialogVisible=!0})},getTreeNodeData:function(e){var t=this;this.treeDialogVisible=!1,this.editForm.deptId=e.id,this.editForm.deptName=e.name,this.editForm.roleId="",Object(o.b)(e.id).then(function(e){t.editRolesOptions=e.data})}},computed:i()({},Object(n.b)(["permissions"])),filters:{statusFilter:function(e){return{0:"有效",1:"无效",9:"锁定"}[e]}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户名"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleSearch(t)}},model:{value:e.listPageParams.username,callback:function(t){e.$set(e.listPageParams,"username",t)},expression:"listPageParams.username"}}),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:function(t){e.handleSearch()}}},[e._v("搜索")]),e._v(" "),e.user_add?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:function(t){e.handleAdd()}}},[e._v("添加")]):e._e()],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"数据加载中...",border:"",fit:"","highlight-current-row":"","default-sort":{prop:"userId",order:"descending"}}},[a("el-table-column",{attrs:{align:"center",label:"序号",sortable:"",prop:"userId"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.userId))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[t.row.avatar?a("img",{staticClass:"user-avatar",staticStyle:{width:"20px",height:"20px","border-radius":"50%"},attrs:{src:t.row.avatar}}):e._e(),e._v("\n          "+e._s(t.row.username)+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"所属角色","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roleList,function(t,s){return a("span",{key:s},[e._v(e._s(t.roleDesc)+" ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"创建时间",sortable:"",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","class-name":"status-col",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(e._f("statusFilter")(t.row.statu)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.user_upd?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"small",type:"success"},on:{click:function(a){e.formEdit(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.user_del?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"small",type:"danger"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listPageParams.pageNo+1,"page-sizes":[20,40,60,80,100],"page-size":e.listPageParams.pageNum,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handlePageNumChange,"current-change":e.handlePageNoChange,"update:currentPage":function(t){e.$set(e.listPageParams,"pageNo + 1",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitleMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输用户名"},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),e._v(" "),"create"==e.dialogStatus?a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"所属部门",prop:"deptId"}},[a("el-input",{attrs:{placeholder:"选择部门",readonly:""},on:{focus:function(t){e.handleDept()}},model:{value:e.editForm.deptName,callback:function(t){e.$set(e.editForm,"deptName",t)},expression:"editForm.deptName"}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.editForm.deptId,expression:"editForm.deptId"}],attrs:{type:"hidden"},domProps:{value:e.editForm.deptId},on:{input:function(t){t.target.composing||e.$set(e.editForm,"deptId",t.target.value)}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择"},model:{value:e.editForm.roleId,callback:function(t){e.$set(e.editForm,"roleId",t)},expression:"editForm.roleId"}},e._l(e.editRolesOptions,function(t){return a("el-option",{key:t.roleId,attrs:{label:t.roleDesc,value:t.roleId,disabled:e.editIsDisabled[t.statu]}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.roleDesc))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.roleCode))])])}))],1),e._v(" "),"update"==e.dialogStatus&&e.user_del?a("el-form-item",{attrs:{label:"状态",prop:"statu"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.editForm.statu,callback:function(t){e.$set(e.editForm,"statu",t)},expression:"editForm.statu"}},e._l(e.statusOptions,function(t,s){return a("el-option",{key:s,attrs:{label:e._f("statusFilter")(t),value:t}})}))],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.formCancel("editForm")}}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.formCreate("editForm")}}},[e._v("确 定")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.formUpdate("editForm")}}},[e._v("修 改")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitleMap[e.dialogStatus],visible:e.treeDialogVisible},on:{"update:visible":function(t){e.treeDialogVisible=t}}},[a("el-tree",{ref:"deptTree",staticClass:"filter-tree",attrs:{data:e.treeDeptData,"default-checked-keys":e.treeCheckedKeys,"check-strictly":"","node-key":"id","highlight-current":"",props:e.treeDefaultProps,"default-expand-all":""},on:{"node-click":e.getTreeNodeData}})],1)],1)},staticRenderFns:[]},c=a("VU/8")(d,u,!1,null,null,null);t.default=c.exports}});